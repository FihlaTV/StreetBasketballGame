var APP={bgColor:13421772,ballRadius:6,basketColor:16711680,getBasketRadius:function(){return APP.ballRadius+2},basketTubeRadius:.5,basketY:20,basketDistance:80,getBasketZ:function(){return APP.getBasketRadius()+2*APP.basketTubeRadius-APP.basketDistance},isMobile:navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry)/),init:function(){APP.world=new WHS.World({autoresize:"window",softbody:!0,background:{color:APP.bgColor},fog:{type:"regular",hex:16777215},camera:{z:50,y:APP.basketY,aspect:45},physics:{fixedTimeStep:!!APP.isMobile&&1/300},gravity:{y:-200}}),APP.camera=APP.world.getCamera(),APP.ProgressLoader=new ProgressLoader(APP.isMobile?12:14),APP.createScene(),APP.addLights(),APP.addBasket(),APP.addBall(),APP.camera.lookAt(new THREE.Vector3(0,APP.basketY,0)),APP.world.start()},createScene:function(){APP.ground=new WHS.Plane({geometry:{buffer:!0,width:1e3,height:800},mass:0,material:{kind:"phong",color:APP.bgColor},pos:{y:-20,z:120},rot:{x:-Math.PI/2}}),APP.ground.addTo(APP.world).then(function(){return APP.ProgressLoader.step()}),APP.wall=APP.ground.clone(),APP.wall.position.y=180,APP.wall.position.z=-APP.basketDistance,APP.wall.rotation.x=0,APP.wall.addTo(APP.world).then(function(){return APP.ProgressLoader.step()}),APP.planeForRaycasting=new THREE.Plane(new THREE.Vector3(0,1,0),-APP.ground.position.y-APP.ballRadius)},addLights:function(){new WHS.PointLight({light:{distance:100,intensity:1,angle:Math.PI},shadowmap:{width:1024,height:1024,left:-50,right:50,top:50,bottom:-50,far:80,fov:90},pos:{y:60,z:-40}}).addTo(APP.world).then(function(){return APP.ProgressLoader.step()}),new WHS.AmbientLight({light:{intensity:.3}}).addTo(APP.world).then(function(){return APP.ProgressLoader.step()})},addBasket:function(){APP.basket=new WHS.Torus({geometry:{buffer:!0,radius:APP.getBasketRadius(),tube:APP.basketTubeRadius,radialSegments:16,tubularSegments:APP.isMobile?8:16},shadow:{cast:!1},mass:0,material:{kind:"standard",color:APP.basketColor,metalness:.8,roughness:.5,emissive:16764159,emissiveIntensity:.2},pos:{y:APP.basketY,z:APP.getBasketZ()},physics:{type:"concave"},rot:{x:Math.PI/2}}),APP.basket.addTo(APP.world).then(function(){return APP.ProgressLoader.step()})},addBall:function(){APP.ball=new WHS.Sphere({geometry:{buffer:!0,radius:APP.ballRadius,widthSegments:APP.isMobile?16:32,heightSegments:APP.isMobile?16:32},mass:120,material:{kind:"phong",map:WHS.texture("textures/ball.png"),normalMap:WHS.texture("textures/ball_normal.png"),shininess:20,reflectivity:2,normalScale:new THREE.Vector2(.5,.5)},physics:{restitution:3}}),APP.ball.addTo(APP.world).then(function(){return APP.ProgressLoader.step()})}};basket.require({url:"bower_components/whitestorm/build/whitestorm.js"}).then(function(){APP.init()});